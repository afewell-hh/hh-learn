{
  "TableName": "hedgehog-learn-users-${stage}",
  "BillingMode": "PAY_PER_REQUEST",
  "AttributeDefinitions": [
    {
      "AttributeName": "PK",
      "AttributeType": "S"
    },
    {
      "AttributeName": "SK",
      "AttributeType": "S"
    },
    {
      "AttributeName": "GSI1PK",
      "AttributeType": "S"
    },
    {
      "AttributeName": "GSI1SK",
      "AttributeType": "S"
    }
  ],
  "KeySchema": [
    {
      "AttributeName": "PK",
      "KeyType": "HASH"
    },
    {
      "AttributeName": "SK",
      "KeyType": "RANGE"
    }
  ],
  "GlobalSecondaryIndexes": [
    {
      "IndexName": "GSI1",
      "KeySchema": [
        {
          "AttributeName": "GSI1PK",
          "KeyType": "HASH"
        },
        {
          "AttributeName": "GSI1SK",
          "KeyType": "RANGE"
        }
      ],
      "Projection": {
        "ProjectionType": "ALL"
      }
    }
  ],
  "StreamSpecification": {
    "StreamViewType": "NEW_AND_OLD_IMAGES"
  },
  "Tags": [
    {
      "Key": "Project",
      "Value": "hedgehog-learn"
    },
    {
      "Key": "Environment",
      "Value": "${stage}"
    },
    {
      "Key": "ManagedBy",
      "Value": "serverless-framework"
    },
    {
      "Key": "Component",
      "Value": "external-sso"
    }
  ],
  "PointInTimeRecoverySpecification": {
    "PointInTimeRecoveryEnabled": true
  },
  "SSESpecification": {
    "Enabled": true,
    "SSEType": "KMS"
  },
  "Schema": {
    "PK": "USER#<cognitoSub>",
    "SK": "PROFILE",
    "GSI1PK": "EMAIL#<email>",
    "GSI1SK": "PROFILE",
    "attributes": {
      "userId": "Cognito sub (unique identifier)",
      "email": "User email address",
      "displayName": "User display name (optional)",
      "givenName": "User given name (optional)",
      "familyName": "User family name (optional)",
      "createdAt": "ISO 8601 timestamp",
      "updatedAt": "ISO 8601 timestamp",
      "lastLoginAt": "ISO 8601 timestamp (optional)",
      "hubspotContactId": "HubSpot CRM contact ID (optional)",
      "preferences": "User preferences object (optional)"
    }
  }
}
